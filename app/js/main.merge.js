/**
 * @update : 2016-11-11 16:22:39
 */
!function(modules){function __webpack_require__(moduleId){if(installedModules[moduleId])return installedModules[moduleId].exports;var module=installedModules[moduleId]={exports:{},id:moduleId,loaded:!1};return modules[moduleId].call(module.exports,module,module.exports,__webpack_require__),module.loaded=!0,module.exports}var installedModules={};return __webpack_require__.m=modules,__webpack_require__.c=installedModules,__webpack_require__.p="",__webpack_require__(0)}([function(module,exports,__webpack_require__){module.exports=__webpack_require__(1)},function(module,exports,__webpack_require__){eval("'use strict';\n\nvar _FullSizeCanvasVideo = __webpack_require__(2);\n\nvar _FullSizeCanvasVideo2 = _interopRequireDefault(_FullSizeCanvasVideo);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n(function ($) {\n  \"use strict\";\n\n  $(document).ready(init);\n\n  function init() {\n    // testNavi();\n    // testNaviHasTimer();\n    // testImageLoader();\n    // testFullSizeBg();\n    // testOverlay();\n    // testFullSizeVideo();\n    testFullSizeCanvasVideo();\n  }\n\n  function testFullSizeCanvasVideo() {\n    var bgMovie = new _FullSizeCanvasVideo2.default({\n      parent: $('.canvas-video'),\n      videoClass: 'video',\n      canvasClass: 'canvas',\n\n      autoplay: true,\n      loop: true,\n      muted: false,\n\n      width: 1920,\n      height: 1080,\n      alignX: 'center',\n      alignY: 'center',\n\n      fps: 30, // TODO\n      videoUrl: 'http://akvod.plaync.com/RK/MOVIES/PREREGISTER3/960x540.mp4',\n      posterUrl: './img/poster.jpg',\n\n      canplayCallback: function canplayCallback(obj) {\n        // iOS, Adr v\n        console.log('external canplayCallback() obj :', obj);\n      },\n\n      timeupdateCallback: function timeupdateCallback(obj) {// iOS, Adr v\n        //console.log('external timeupdateCallback() obj :', obj);\n      },\n\n      endedCallback: function endedCallback(obj) {\n        // iOS, Adr v\n        console.log('external endedCallback() obj :', obj);\n      },\n\n      visibilitychangeCallback: function visibilitychangeCallback(obj) {\n        console.log('extenal visibilitychangeCallback() obj :', obj);\n\n        if (obj.documentHidden) {\n          bgMovie.pause();\n        } else {\n          bgMovie.play();\n        }\n      }\n    });\n    bgMovie.init();\n\n    $(window).on('resize', function (evt) {\n      console.log('main.js - resize. window.innerWidth, window.innerHeight :', window.innerWidth, window.innerHeight);\n\n      $('.canvas-video').css({\n        width: window.innerWidth,\n        height: window.innerHeight\n      });\n\n      $('#wrapper').css({\n        width: window.innerWidth,\n        height: window.innerHeight\n      });\n    }).trigger('resize');\n\n    // test btns\n    $('#btn-play').on('click', function (evt) {\n      evt.preventDefault();\n      bgMovie.play();\n    });\n\n    $('#btn-pause').on('click', function (evt) {\n      evt.preventDefault();\n      bgMovie.pause();\n    });\n\n    $('#btn-stop').on('click', function (evt) {\n      evt.preventDefault();\n      bgMovie.stop();\n    });\n\n    $('#btn-seek').on('click', function (evt) {\n      evt.preventDefault();\n      bgMovie.seek(30);\n    });\n  }\n})(jQuery); // import Navi from './component/Navi';\n// import NaviHasTimer from './component/NaviHasTimer';\n// import ImageLoader from './component/ImageLoader';\n// import FullSizeBg from './component/FullSizeBg';\n// import Overlay from './component/Overlay';\n// import FullSizeVideo from './component/FullSizeVideo';//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9hcHAvc3JjL21haW4uanM/MTdmNiJdLCJuYW1lcyI6WyIkIiwiZG9jdW1lbnQiLCJyZWFkeSIsImluaXQiLCJ0ZXN0RnVsbFNpemVDYW52YXNWaWRlbyIsImJnTW92aWUiLCJwYXJlbnQiLCJ2aWRlb0NsYXNzIiwiY2FudmFzQ2xhc3MiLCJhdXRvcGxheSIsImxvb3AiLCJtdXRlZCIsIndpZHRoIiwiaGVpZ2h0IiwiYWxpZ25YIiwiYWxpZ25ZIiwiZnBzIiwidmlkZW9VcmwiLCJwb3N0ZXJVcmwiLCJjYW5wbGF5Q2FsbGJhY2siLCJvYmoiLCJjb25zb2xlIiwibG9nIiwidGltZXVwZGF0ZUNhbGxiYWNrIiwiZW5kZWRDYWxsYmFjayIsInZpc2liaWxpdHljaGFuZ2VDYWxsYmFjayIsImRvY3VtZW50SGlkZGVuIiwicGF1c2UiLCJwbGF5Iiwid2luZG93Iiwib24iLCJldnQiLCJpbm5lcldpZHRoIiwiaW5uZXJIZWlnaHQiLCJjc3MiLCJ0cmlnZ2VyIiwicHJldmVudERlZmF1bHQiLCJzdG9wIiwic2VlayIsImpRdWVyeSJdLCJtYXBwaW5ncyI6Ijs7QUFNQTs7Ozs7O0FBRUMsV0FBU0EsQ0FBVCxFQUFZO0FBQ1g7O0FBQ0FBLElBQUVDLFFBQUYsRUFBWUMsS0FBWixDQUFrQkMsSUFBbEI7O0FBRUEsV0FBU0EsSUFBVCxHQUFnQjtBQUNkO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBQztBQUNEOztBQUVELFdBQVNBLHVCQUFULEdBQW1DO0FBQ2pDLFFBQUlDLFVBQVUsa0NBQXdCO0FBQ3BDQyxjQUFRTixFQUFFLGVBQUYsQ0FENEI7QUFFcENPLGtCQUFZLE9BRndCO0FBR3BDQyxtQkFBYSxRQUh1Qjs7QUFLcENDLGdCQUFVLElBTDBCO0FBTXBDQyxZQUFNLElBTjhCO0FBT3BDQyxhQUFPLEtBUDZCOztBQVNwQ0MsYUFBTyxJQVQ2QjtBQVVwQ0MsY0FBUSxJQVY0QjtBQVdwQ0MsY0FBUSxRQVg0QjtBQVlwQ0MsY0FBUSxRQVo0Qjs7QUFjcENDLFdBQUssRUFkK0IsRUFjM0I7QUFDVEMsZ0JBQVUsNERBZjBCO0FBZ0JwQ0MsaUJBQVcsa0JBaEJ5Qjs7QUFrQnBDQyx1QkFBaUIseUJBQUNDLEdBQUQsRUFBUztBQUFFO0FBQzFCQyxnQkFBUUMsR0FBUixDQUFZLGtDQUFaLEVBQWdERixHQUFoRDtBQUNELE9BcEJtQzs7QUFzQnBDRywwQkFBb0IsNEJBQUNILEdBQUQsRUFBUyxDQUFFO0FBQzdCO0FBQ0QsT0F4Qm1DOztBQTBCcENJLHFCQUFlLHVCQUFDSixHQUFELEVBQVM7QUFBRTtBQUN4QkMsZ0JBQVFDLEdBQVIsQ0FBWSxnQ0FBWixFQUE4Q0YsR0FBOUM7QUFDRCxPQTVCbUM7O0FBOEJwQ0ssZ0NBQTBCLGtDQUFDTCxHQUFELEVBQVM7QUFDakNDLGdCQUFRQyxHQUFSLENBQVksMENBQVosRUFBd0RGLEdBQXhEOztBQUVBLFlBQUdBLElBQUlNLGNBQVAsRUFBdUI7QUFDckJyQixrQkFBUXNCLEtBQVI7QUFDRCxTQUZELE1BRU87QUFDTHRCLGtCQUFRdUIsSUFBUjtBQUNEO0FBQ0Y7QUF0Q21DLEtBQXhCLENBQWQ7QUF3Q0F2QixZQUFRRixJQUFSOztBQUVBSCxNQUFFNkIsTUFBRixFQUFVQyxFQUFWLENBQWEsUUFBYixFQUF1QixVQUFTQyxHQUFULEVBQWM7QUFDbkNWLGNBQVFDLEdBQVIsQ0FBWSwyREFBWixFQUF5RU8sT0FBT0csVUFBaEYsRUFBNEZILE9BQU9JLFdBQW5HOztBQUVBakMsUUFBRSxlQUFGLEVBQW1Ca0MsR0FBbkIsQ0FBdUI7QUFDckJ0QixlQUFPaUIsT0FBT0csVUFETztBQUVyQm5CLGdCQUFRZ0IsT0FBT0k7QUFGTSxPQUF2Qjs7QUFLQWpDLFFBQUUsVUFBRixFQUFja0MsR0FBZCxDQUFrQjtBQUNoQnRCLGVBQU9pQixPQUFPRyxVQURFO0FBRWhCbkIsZ0JBQVFnQixPQUFPSTtBQUZDLE9BQWxCO0FBSUQsS0FaRCxFQVlHRSxPQVpILENBWVcsUUFaWDs7QUFjQTtBQUNBbkMsTUFBRSxXQUFGLEVBQWU4QixFQUFmLENBQWtCLE9BQWxCLEVBQTJCLFVBQVNDLEdBQVQsRUFBYztBQUN2Q0EsVUFBSUssY0FBSjtBQUNBL0IsY0FBUXVCLElBQVI7QUFDRCxLQUhEOztBQUtBNUIsTUFBRSxZQUFGLEVBQWdCOEIsRUFBaEIsQ0FBbUIsT0FBbkIsRUFBNEIsVUFBU0MsR0FBVCxFQUFjO0FBQ3hDQSxVQUFJSyxjQUFKO0FBQ0EvQixjQUFRc0IsS0FBUjtBQUNELEtBSEQ7O0FBS0EzQixNQUFFLFdBQUYsRUFBZThCLEVBQWYsQ0FBa0IsT0FBbEIsRUFBMkIsVUFBU0MsR0FBVCxFQUFjO0FBQ3ZDQSxVQUFJSyxjQUFKO0FBQ0EvQixjQUFRZ0MsSUFBUjtBQUNELEtBSEQ7O0FBS0FyQyxNQUFFLFdBQUYsRUFBZThCLEVBQWYsQ0FBa0IsT0FBbEIsRUFBMkIsVUFBU0MsR0FBVCxFQUFjO0FBQ3ZDQSxVQUFJSyxjQUFKO0FBQ0EvQixjQUFRaUMsSUFBUixDQUFhLEVBQWI7QUFDRCxLQUhEO0FBSUQ7QUFDRixDQTVGQSxFQTRGQ0MsTUE1RkQsQ0FBRCxDLENBUkE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6IjEuanMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBpbXBvcnQgTmF2aSBmcm9tICcuL2NvbXBvbmVudC9OYXZpJztcclxuLy8gaW1wb3J0IE5hdmlIYXNUaW1lciBmcm9tICcuL2NvbXBvbmVudC9OYXZpSGFzVGltZXInO1xyXG4vLyBpbXBvcnQgSW1hZ2VMb2FkZXIgZnJvbSAnLi9jb21wb25lbnQvSW1hZ2VMb2FkZXInO1xyXG4vLyBpbXBvcnQgRnVsbFNpemVCZyBmcm9tICcuL2NvbXBvbmVudC9GdWxsU2l6ZUJnJztcclxuLy8gaW1wb3J0IE92ZXJsYXkgZnJvbSAnLi9jb21wb25lbnQvT3ZlcmxheSc7XHJcbi8vIGltcG9ydCBGdWxsU2l6ZVZpZGVvIGZyb20gJy4vY29tcG9uZW50L0Z1bGxTaXplVmlkZW8nO1xyXG5pbXBvcnQgRnVsbFNpemVDYW52YXNWaWRlbyBmcm9tICcuL2NvbXBvbmVudC9GdWxsU2l6ZUNhbnZhc1ZpZGVvJztcclxuXHJcbihmdW5jdGlvbigkKSB7XHJcbiAgXCJ1c2Ugc3RyaWN0XCI7XHJcbiAgJChkb2N1bWVudCkucmVhZHkoaW5pdCk7XHJcblxyXG4gIGZ1bmN0aW9uIGluaXQoKSB7XHJcbiAgICAvLyB0ZXN0TmF2aSgpO1xyXG4gICAgLy8gdGVzdE5hdmlIYXNUaW1lcigpO1xyXG4gICAgLy8gdGVzdEltYWdlTG9hZGVyKCk7XHJcbiAgICAvLyB0ZXN0RnVsbFNpemVCZygpO1xyXG4gICAgLy8gdGVzdE92ZXJsYXkoKTtcclxuICAgIC8vIHRlc3RGdWxsU2l6ZVZpZGVvKCk7XHJcbiAgICB0ZXN0RnVsbFNpemVDYW52YXNWaWRlbygpO1xyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gdGVzdEZ1bGxTaXplQ2FudmFzVmlkZW8oKSB7XHJcbiAgICBsZXQgYmdNb3ZpZSA9IG5ldyBGdWxsU2l6ZUNhbnZhc1ZpZGVvKHtcclxuICAgICAgcGFyZW50OiAkKCcuY2FudmFzLXZpZGVvJyksXHJcbiAgICAgIHZpZGVvQ2xhc3M6ICd2aWRlbycsXHJcbiAgICAgIGNhbnZhc0NsYXNzOiAnY2FudmFzJyxcclxuXHJcbiAgICAgIGF1dG9wbGF5OiB0cnVlLFxyXG4gICAgICBsb29wOiB0cnVlLFxyXG4gICAgICBtdXRlZDogZmFsc2UsXHJcblxyXG4gICAgICB3aWR0aDogMTkyMCxcclxuICAgICAgaGVpZ2h0OiAxMDgwLFxyXG4gICAgICBhbGlnblg6ICdjZW50ZXInLFxyXG4gICAgICBhbGlnblk6ICdjZW50ZXInLFxyXG5cclxuICAgICAgZnBzOiAzMCwgLy8gVE9ET1xyXG4gICAgICB2aWRlb1VybDogJ2h0dHA6Ly9ha3ZvZC5wbGF5bmMuY29tL1JLL01PVklFUy9QUkVSRUdJU1RFUjMvOTYweDU0MC5tcDQnLFxyXG4gICAgICBwb3N0ZXJVcmw6ICcuL2ltZy9wb3N0ZXIuanBnJyxcclxuXHJcbiAgICAgIGNhbnBsYXlDYWxsYmFjazogKG9iaikgPT4geyAvLyBpT1MsIEFkciB2XHJcbiAgICAgICAgY29uc29sZS5sb2coJ2V4dGVybmFsIGNhbnBsYXlDYWxsYmFjaygpIG9iaiA6Jywgb2JqKTtcclxuICAgICAgfSxcclxuXHJcbiAgICAgIHRpbWV1cGRhdGVDYWxsYmFjazogKG9iaikgPT4geyAvLyBpT1MsIEFkciB2XHJcbiAgICAgICAgLy9jb25zb2xlLmxvZygnZXh0ZXJuYWwgdGltZXVwZGF0ZUNhbGxiYWNrKCkgb2JqIDonLCBvYmopO1xyXG4gICAgICB9LFxyXG5cclxuICAgICAgZW5kZWRDYWxsYmFjazogKG9iaikgPT4geyAvLyBpT1MsIEFkciB2XHJcbiAgICAgICAgY29uc29sZS5sb2coJ2V4dGVybmFsIGVuZGVkQ2FsbGJhY2soKSBvYmogOicsIG9iaik7XHJcbiAgICAgIH0sXHJcblxyXG4gICAgICB2aXNpYmlsaXR5Y2hhbmdlQ2FsbGJhY2s6IChvYmopID0+IHtcclxuICAgICAgICBjb25zb2xlLmxvZygnZXh0ZW5hbCB2aXNpYmlsaXR5Y2hhbmdlQ2FsbGJhY2soKSBvYmogOicsIG9iaik7XHJcblxyXG4gICAgICAgIGlmKG9iai5kb2N1bWVudEhpZGRlbikge1xyXG4gICAgICAgICAgYmdNb3ZpZS5wYXVzZSgpO1xyXG4gICAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgICBiZ01vdmllLnBsYXkoKTtcclxuICAgICAgICB9XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gICAgYmdNb3ZpZS5pbml0KCk7XHJcblxyXG4gICAgJCh3aW5kb3cpLm9uKCdyZXNpemUnLCBmdW5jdGlvbihldnQpIHtcclxuICAgICAgY29uc29sZS5sb2coJ21haW4uanMgLSByZXNpemUuIHdpbmRvdy5pbm5lcldpZHRoLCB3aW5kb3cuaW5uZXJIZWlnaHQgOicsIHdpbmRvdy5pbm5lcldpZHRoLCB3aW5kb3cuaW5uZXJIZWlnaHQpO1xyXG5cclxuICAgICAgJCgnLmNhbnZhcy12aWRlbycpLmNzcyh7XHJcbiAgICAgICAgd2lkdGg6IHdpbmRvdy5pbm5lcldpZHRoLFxyXG4gICAgICAgIGhlaWdodDogd2luZG93LmlubmVySGVpZ2h0XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgJCgnI3dyYXBwZXInKS5jc3Moe1xyXG4gICAgICAgIHdpZHRoOiB3aW5kb3cuaW5uZXJXaWR0aCxcclxuICAgICAgICBoZWlnaHQ6IHdpbmRvdy5pbm5lckhlaWdodFxyXG4gICAgICB9KTtcclxuICAgIH0pLnRyaWdnZXIoJ3Jlc2l6ZScpO1xyXG5cclxuICAgIC8vIHRlc3QgYnRuc1xyXG4gICAgJCgnI2J0bi1wbGF5Jykub24oJ2NsaWNrJywgZnVuY3Rpb24oZXZ0KSB7XHJcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gICAgICBiZ01vdmllLnBsYXkoKTtcclxuICAgIH0pO1xyXG5cclxuICAgICQoJyNidG4tcGF1c2UnKS5vbignY2xpY2snLCBmdW5jdGlvbihldnQpIHtcclxuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIGJnTW92aWUucGF1c2UoKTtcclxuICAgIH0pO1xyXG5cclxuICAgICQoJyNidG4tc3RvcCcpLm9uKCdjbGljaycsIGZ1bmN0aW9uKGV2dCkge1xyXG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcclxuICAgICAgYmdNb3ZpZS5zdG9wKCk7XHJcbiAgICB9KTtcclxuXHJcbiAgICAkKCcjYnRuLXNlZWsnKS5vbignY2xpY2snLCBmdW5jdGlvbihldnQpIHtcclxuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XHJcbiAgICAgIGJnTW92aWUuc2VlaygzMCk7XHJcbiAgICB9KTtcclxuICB9XHJcbn0oalF1ZXJ5KSk7XG5cblxuLy8gV0VCUEFDSyBGT09URVIgLy9cbi8vIC4vYXBwL3NyYy9tYWluLmpzIl0sInNvdXJjZVJvb3QiOiIifQ==")},function(module,exports){eval("'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nvar FullSizeCanvasVideo = function () {\n  function FullSizeCanvasVideo(options) {\n    _classCallCheck(this, FullSizeCanvasVideo);\n\n    var _ = this;\n\n    _.option = {\n      parent: null,\n      videoClass: 'video',\n      canvasClass: 'canvas',\n      width: 320,\n      height: 240,\n      alignX: 'center',\n      alignY: 'center',\n\n      fps: 30, // TODO\n      videoUrl: '',\n      posterUrl: '',\n\n      autoplay: true,\n      loop: true,\n      muted: false,\n\n      canplayCallback: null,\n      timeupdateCallback: null,\n      endedCallback: null,\n\n      visibilitychangeCallback: null\n    };\n    Object.assign(_.option, options);\n\n    _.parent = _.option.parent;\n\n    if (_.parent.length <= 0) {\n      throw new Error('FullSizeCanvasVideo Class require options have parent.');\n      return;\n    }\n\n    _.$video = null;\n    _.$canvas = null;\n\n    _.video = null;\n    _.canvas = null;\n    _.ctx = null;\n\n    _.isPlaying = false;\n    _.lastRenderTime = 0;\n    _.animationFrame = null;\n\n    _.$proxyResize = $.proxy(_.resize, _);\n  }\n\n  _createClass(FullSizeCanvasVideo, [{\n    key: 'init',\n    value: function init(obj) {\n      this.setInstance();\n      this.setCallbacks();\n    }\n  }, {\n    key: 'setInstance',\n    value: function setInstance() {\n      var _ = this,\n          opt = _.option;\n\n      _.$video = $(_.getVideoTpl());\n      _.$canvas = $(_.getCanvasTpl());\n      _.parent.append(_.$video);\n      _.parent.append(_.$canvas);\n\n      _.video = _.$video.get(0);\n      _.canvas = _.$canvas.get(0);\n      _.ctx = this.canvas.getContext('2d');\n\n      if (opt.loop === true) _.video.setAttribute('loop', '');\n      if (opt.muted === true) _.video.setAttribute('muted', '');\n      if (opt.autoplay === true) _.video.setAttribute('autoplay', ''); // iOS video node already has \"autoplay\" attribute\n\n      var size = _.getVideoSizeAspectFill();\n      _.setVideoSize(size.width, size.height);\n      _.setCanvasSize(size.width, size.height);\n      _.setWrapAlign(opt.alignX, opt.alignY, size);\n\n      var isVideoHasOnended = _.video.hasOwnProperty('onended');\n      if (_.isIOS()) {\n        _.$video.hide();\n\n        _.play();\n        if (!_.option.autoplay) _.pause();\n      } else {\n        this.$canvas.hide();\n\n        _.$video.on('click', function (evt) {\n          _.play();\n        });\n      }\n\n      $(window).on('resize', _.$proxyResize);\n      _.resize();\n    }\n  }, {\n    key: 'setCallbacks',\n    value: function setCallbacks() {\n      var _ = this,\n          opt = _.option,\n          isVideoHasOnended = _.video.hasOwnProperty('onended');\n\n      if (_.isIOS()) {\n        _.$video.on('canplay', function (evt) {\n          _.drawVideoToCanvas();\n          if (opt.canplayCallback) {\n            opt.canplayCallback.call(null, {\n              event: evt,\n              video: _.video\n            });\n          }\n        });\n\n        _.$video.on('timeupdate', function (evt) {\n          _.drawVideoToCanvas();\n\n          if (opt.timeupdateCallback) {\n            opt.timeupdateCallback.call(null, {\n              event: evt,\n              video: _.video,\n              currentTime: _.video.currentTime,\n              duration: _.video.duration\n            });\n          }\n        });\n      } else {\n        _.$video.on('canplay', function (evt) {\n          if (opt.canplayCallback) {\n            opt.canplayCallback.call(null, {\n              event: evt,\n              video: _.video\n            });\n          }\n        });\n\n        if (opt.timeupdateCallback || !isVideoHasOnended && opt.endedCallback) {\n          _.$video.on('timeupdate', function (evt) {\n            if (opt.timeupdateCallback) {\n              opt.timeupdateCallback.call(null, {\n                event: evt,\n                video: _.video,\n                currentTime: _.video.currentTime,\n                duration: _.video.duration\n              });\n            }\n\n            if (opt.endedCallback && _.video.currentTime >= _.video.duration) {\n              if (opt.loop === true) return;\n\n              _.isPlaying = false;\n\n              opt.endedCallback.call(null, {\n                event: evt,\n                video: _.video,\n                currentTime: _.video.currentTime,\n                duration: _.video.duration\n              });\n            }\n          });\n        }\n\n        if (isVideoHasOnended && opt.endedCallback) {\n          // TODO - no browser support 'ended' event now.\n          $(video).on('ended', function (evt) {\n            _.isPlaying = false;\n\n            opt.endedCallback.call(null, {\n              event: evt,\n              video: _.video,\n              currentTime: _.video.currentTime,\n              duration: _.video.duration\n            });\n          });\n        }\n      }\n\n      if (opt.visibilitychangeCallback) {\n        (function () {\n          // todo - pc v\n          var hidden = void 0,\n              visibilityState = void 0,\n              visibilityChange = void 0;\n          if (typeof document.hidden !== 'undefined') {\n            // Opera 12.10 and Firefox 18 and later support\n            hidden = 'hidden';\n            visibilityState = 'visibilityState';\n            visibilityChange = 'visibilitychange';\n          } else if (typeof document.msHidden !== 'undefined') {\n            hidden = 'msHidden';\n            visibilityState = 'msVisibilityState';\n            visibilityChange = 'msvisibilitychange';\n          } else if (typeof document.webkitHidden !== 'undefined') {\n            hidden = 'webkitHidden';\n            visibilityState = 'webkitVisibilityState';\n            visibilityChange = 'webkitvisibilitychange';\n          }\n\n          $(document).on(visibilityChange, function (evt) {\n            console.log('visibilitychange :', evt);\n            console.log('hidden', document[hidden]);\n            console.log('visibilityState', document[visibilityState]); // visible, hidden, prerender, unloaded\n\n            opt.visibilitychangeCallback.call(null, {\n              event: evt,\n              video: _.video,\n              documentHidden: document[hidden],\n              documentVisibilityState: document[visibilityState]\n            });\n          });\n        })();\n      }\n    }\n  }, {\n    key: 'setWrapAlign',\n    value: function setWrapAlign(alignX, alignY, modifiedSize) {\n      var winWidth = window.innerWidth,\n          winHeight = window.innerHeight,\n          left = 0,\n          top = 0;\n\n      switch (alignX) {\n        case 'left':\n          left = 0;\n          break;\n\n        case 'center':\n          left = Math.round((winWidth - modifiedSize.width) / 2);\n          break;\n\n        case 'right':\n          left = Math.round(winWidth - modifiedSize.width);\n          break;\n      }\n\n      switch (alignY) {\n        case 'top':\n          top = 0;\n          break;\n\n        case 'center':\n          top = Math.round((winHeight - modifiedSize.height) / 2);\n          break;\n\n        case 'bottom':\n          top = Math.round(winHeight - modifiedSize.height);\n          break;\n      }\n\n      this.setVideoPosition({ left: left, top: top });\n      this.setCanvasPosition({ left: left, top: top });\n    }\n  }, {\n    key: 'setVideoPosition',\n    value: function setVideoPosition(cssObj) {\n      this.$video.css(cssObj);\n    }\n  }, {\n    key: 'setCanvasPosition',\n    value: function setCanvasPosition(cssObj) {\n      this.$canvas.css(cssObj);\n    }\n  }, {\n    key: 'setVideoSize',\n    value: function setVideoSize(width, height) {\n      this.$video.width(width);\n      this.$video.height(height);\n    }\n  }, {\n    key: 'setCanvasSize',\n    value: function setCanvasSize(width, height) {\n      var _ = this;\n\n      if (_.isIOS()) {\n        _.ctx.canvas.width = width;\n        _.ctx.canvas.height = height;\n        _.$canvas.attr({ width: width, height: height });\n      }\n    }\n  }, {\n    key: 'drawVideoToCanvas',\n    value: function drawVideoToCanvas() {\n      var _ = this;\n      _.ctx.drawImage(_.video, 0, 0, _.$video.width(), _.$video.height());\n    }\n  }, {\n    key: 'loopAnimationFrameIOS',\n    value: function loopAnimationFrameIOS() {\n      var _ = this,\n          opt = _.option;\n\n      var now = Date.now(),\n          elapsedTime = (now - _.lastRenderTime) / 1000;\n\n      if (elapsedTime >= 1 / _.option.fps) {\n        _.video.currentTime = _.video.currentTime + elapsedTime;\n        _.lastRenderTime = now;\n      }\n\n      if (_.video.currentTime >= _.video.duration) {\n        _.isPlaying = false;\n\n        if (opt.loop === true) {\n          _.seek(0);\n          _.play();\n        } else {\n          opt.endedCallback.call(null, {\n            event: null,\n            video: _.video,\n            currentTime: _.video.currentTime,\n            duration: _.video.duration\n          });\n\n          _.stop();\n        }\n      }\n\n      if (_.isPlaying) {\n        _.animationFrame = requestAnimationFrame(function () {\n          _.loopAnimationFrameIOS();\n        });\n      } else {\n        cancelAnimationFrame(_.animationFrame);\n        _.animationFrame = null;\n      }\n    }\n  }, {\n    key: 'resize',\n    value: function resize(evt) {\n      var _ = this,\n          size = _.getVideoSizeAspectFill();\n\n      _.setVideoSize(size.width, size.height);\n      _.setCanvasSize(size.width, size.height);\n      _.setWrapAlign(_.option.alignX, _.option.alignY, size);\n\n      if (_.isIOS()) _.drawVideoToCanvas();\n    }\n  }, {\n    key: 'getVideoTpl',\n    value: function getVideoTpl() {\n      var _ = this,\n          opt = _.option;\n\n      var videoSourceTpl = '',\n          ext = opt.videoUrl.split('.').pop().toLowerCase();\n      videoSourceTpl += '<source src=\"' + opt.videoUrl + '\" type=\"video/' + ext + '\"></source>';\n\n      var tpl = '<video class=\"' + opt.videoClass + '\" poster=\"' + opt.posterUrl + '\">' + videoSourceTpl + '</video>';\n      if (_.isIOS()) {\n        tpl = '<video class=\"' + opt.videoClass + '\" poster=\"' + opt.posterUrl + '\" autoplay>' + videoSourceTpl + '</video>';\n      }\n      //let tpl = `<video class=\"${opt.videoClass}\" muted=\"true\" loop=\"true\" autoplay=\"true\" poster=\"\">${videoSourceTpl}</video>`;\n\n      return tpl;\n    }\n  }, {\n    key: 'getCanvasTpl',\n    value: function getCanvasTpl() {\n      return '<canvas class=\"' + this.option.canvasClass + '\"></canvas>';\n    }\n  }, {\n    key: 'getVideoSizeAspectFill',\n    value: function getVideoSizeAspectFill() {\n      var _ = this,\n          opt = _.option;\n\n      var winWidth = window.innerWidth,\n          winHeight = window.innerHeight,\n          modifiedSizeW = winWidth,\n          modifiedSizeH = Math.ceil(winWidth / opt.width * opt.height);\n\n      if (modifiedSizeH < winHeight) {\n        modifiedSizeW = Math.ceil(winHeight / opt.height * opt.width);\n        modifiedSizeH = winHeight;\n      }\n\n      return {\n        width: modifiedSizeW,\n        height: modifiedSizeH\n      };\n    }\n  }, {\n    key: 'isIOS',\n    value: function isIOS() {\n      return (/iPad|iPhone|iPod/.test(navigator.platform)\n      );\n    }\n  }, {\n    key: 'play',\n    value: function play() {\n      var _ = this;\n      if (!_.video) return;\n\n      if (_.isIOS()) {\n        _.lastRenderTime = Date.now();\n        _.isPlaying = true;\n        _.loopAnimationFrameIOS();\n      } else {\n        _.isPlaying = true;\n        _.video.play();\n      }\n    }\n  }, {\n    key: 'pause',\n    value: function pause() {\n      var _ = this;\n      if (!_.video) return;\n\n      if (_.isIOS()) {\n        _.isPlaying = false;\n      } else {\n        _.isPlaying = false;\n        _.video.pause();\n      }\n    }\n  }, {\n    key: 'stop',\n    value: function stop() {\n      var _ = this;\n      if (!_.video) return;\n\n      if (_.isIOS()) {\n        _.pause();\n        _.seek(0);\n      } else {\n        _.video.pause();\n        _.video.currentTime = 0;\n      }\n    }\n  }, {\n    key: 'seek',\n    value: function seek(second) {\n      var _ = this;\n      if (!_.video) return;\n\n      if (_.isIOS()) {\n        _.video.currentTime = second;\n      } else {\n        _.video.currentTime = second;\n      }\n    }\n  }]);\n\n  return FullSizeCanvasVideo;\n}();\n\nexports.default = FullSizeCanvasVideo;//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8vLi9hcHAvc3JjL2NvbXBvbmVudC9GdWxsU2l6ZUNhbnZhc1ZpZGVvLmpzPzU2NDMiXSwibmFtZXMiOlsiRnVsbFNpemVDYW52YXNWaWRlbyIsIm9wdGlvbnMiLCJfIiwib3B0aW9uIiwicGFyZW50IiwidmlkZW9DbGFzcyIsImNhbnZhc0NsYXNzIiwid2lkdGgiLCJoZWlnaHQiLCJhbGlnblgiLCJhbGlnblkiLCJmcHMiLCJ2aWRlb1VybCIsInBvc3RlclVybCIsImF1dG9wbGF5IiwibG9vcCIsIm11dGVkIiwiY2FucGxheUNhbGxiYWNrIiwidGltZXVwZGF0ZUNhbGxiYWNrIiwiZW5kZWRDYWxsYmFjayIsInZpc2liaWxpdHljaGFuZ2VDYWxsYmFjayIsIk9iamVjdCIsImFzc2lnbiIsImxlbmd0aCIsIkVycm9yIiwiJHZpZGVvIiwiJGNhbnZhcyIsInZpZGVvIiwiY2FudmFzIiwiY3R4IiwiaXNQbGF5aW5nIiwibGFzdFJlbmRlclRpbWUiLCJhbmltYXRpb25GcmFtZSIsIiRwcm94eVJlc2l6ZSIsIiQiLCJwcm94eSIsInJlc2l6ZSIsIm9iaiIsInNldEluc3RhbmNlIiwic2V0Q2FsbGJhY2tzIiwib3B0IiwiZ2V0VmlkZW9UcGwiLCJnZXRDYW52YXNUcGwiLCJhcHBlbmQiLCJnZXQiLCJnZXRDb250ZXh0Iiwic2V0QXR0cmlidXRlIiwic2l6ZSIsImdldFZpZGVvU2l6ZUFzcGVjdEZpbGwiLCJzZXRWaWRlb1NpemUiLCJzZXRDYW52YXNTaXplIiwic2V0V3JhcEFsaWduIiwiaXNWaWRlb0hhc09uZW5kZWQiLCJoYXNPd25Qcm9wZXJ0eSIsImlzSU9TIiwiaGlkZSIsInBsYXkiLCJwYXVzZSIsIm9uIiwiZXZ0Iiwid2luZG93IiwiZHJhd1ZpZGVvVG9DYW52YXMiLCJjYWxsIiwiZXZlbnQiLCJjdXJyZW50VGltZSIsImR1cmF0aW9uIiwiaGlkZGVuIiwidmlzaWJpbGl0eVN0YXRlIiwidmlzaWJpbGl0eUNoYW5nZSIsImRvY3VtZW50IiwibXNIaWRkZW4iLCJ3ZWJraXRIaWRkZW4iLCJjb25zb2xlIiwibG9nIiwiZG9jdW1lbnRIaWRkZW4iLCJkb2N1bWVudFZpc2liaWxpdHlTdGF0ZSIsIm1vZGlmaWVkU2l6ZSIsIndpbldpZHRoIiwiaW5uZXJXaWR0aCIsIndpbkhlaWdodCIsImlubmVySGVpZ2h0IiwibGVmdCIsInRvcCIsIk1hdGgiLCJyb3VuZCIsInNldFZpZGVvUG9zaXRpb24iLCJzZXRDYW52YXNQb3NpdGlvbiIsImNzc09iaiIsImNzcyIsImF0dHIiLCJkcmF3SW1hZ2UiLCJub3ciLCJEYXRlIiwiZWxhcHNlZFRpbWUiLCJzZWVrIiwic3RvcCIsInJlcXVlc3RBbmltYXRpb25GcmFtZSIsImxvb3BBbmltYXRpb25GcmFtZUlPUyIsImNhbmNlbEFuaW1hdGlvbkZyYW1lIiwidmlkZW9Tb3VyY2VUcGwiLCJleHQiLCJzcGxpdCIsInBvcCIsInRvTG93ZXJDYXNlIiwidHBsIiwibW9kaWZpZWRTaXplVyIsIm1vZGlmaWVkU2l6ZUgiLCJjZWlsIiwidGVzdCIsIm5hdmlnYXRvciIsInBsYXRmb3JtIiwic2Vjb25kIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7O0lBQU1BLG1CO0FBQ0osK0JBQVlDLE9BQVosRUFBcUI7QUFBQTs7QUFDbkIsUUFBSUMsSUFBSSxJQUFSOztBQUVBQSxNQUFFQyxNQUFGLEdBQVc7QUFDVEMsY0FBUSxJQURDO0FBRVRDLGtCQUFZLE9BRkg7QUFHVEMsbUJBQWEsUUFISjtBQUlUQyxhQUFPLEdBSkU7QUFLVEMsY0FBUSxHQUxDO0FBTVRDLGNBQVEsUUFOQztBQU9UQyxjQUFRLFFBUEM7O0FBU1RDLFdBQUssRUFUSSxFQVNBO0FBQ1RDLGdCQUFVLEVBVkQ7QUFXVEMsaUJBQVcsRUFYRjs7QUFhVEMsZ0JBQVUsSUFiRDtBQWNUQyxZQUFNLElBZEc7QUFlVEMsYUFBTyxLQWZFOztBQWlCVEMsdUJBQWlCLElBakJSO0FBa0JUQywwQkFBb0IsSUFsQlg7QUFtQlRDLHFCQUFlLElBbkJOOztBQXFCVEMsZ0NBQTBC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TztBQUNMNUIsVUFBRTRCLFNBQUYsR0FBYyxLQUFkO0FBQ0E1QixVQUFFeUIsS0FBRixDQUFROEIsS0FBUjtBQUNEO0FBQ0Y7OzsyQkFFTTtBQUNMLFVBQUl2RCxJQUFJLElBQVI7QUFDQSxVQUFJLENBQUNBLEVBQUV5QixLQUFQLEVBQWM7O0FBRWQsVUFBSXpCLEVBQUVvRCxLQUFGLEVBQUosRUFBZTtBQUNicEQsVUFBRXVELEtBQUY7QUFDQXZELFVBQUU0RixJQUFGLENBQU8sQ0FBUDtBQUNELE9BSEQsTUFHTztBQUNMNUYsVUFBRXlCLEtBQUYsQ0FBUThCLEtBQVI7QUFDQXZELFVBQUV5QixLQUFGLENBQVFxQyxXQUFSLEdBQXNCLENBQXRCO0FBQ0Q7QUFDRjs7O3lCQUVJK0MsTSxFQUFRO0FBQ1gsVUFBSTdHLElBQUksSUFBUjtBQUNBLFVBQUksQ0FBQ0EsRUFBRXlCLEtBQVAsRUFBYzs7QUFFZCxVQUFJekIsRUFBRW9ELEtBQUYsRUFBSixFQUFlO0FBQ2JwRCxVQUFFeUIsS0FBRixDQUFRcUMsV0FBUixHQUFzQitDLE1BQXRCO0FBQ0QsT0FGRCxNQUVPO0FBQ0w3RyxVQUFFeUIsS0FBRixDQUFRcUMsV0FBUixHQUFzQitDLE1BQXRCO0FBQ0Q7QUFDRjs7Ozs7O2tCQUdZL0csbUIiLCJmaWxlIjoiMi5qcyIsInNvdXJjZXNDb250ZW50IjpbImNsYXNzIEZ1bGxTaXplQ2FudmFzVmlkZW8ge1xyXG4gIGNvbnN0cnVjdG9yKG9wdGlvbnMpIHtcclxuICAgIGxldCBfID0gdGhpcztcclxuXHJcbiAgICBfLm9wdGlvbiA9IHtcclxuICAgICAgcGFyZW50OiBudWxsLFxyXG4gICAgICB2aWRlb0NsYXNzOiAndmlkZW8nLFxyXG4gICAgICBjYW52YXNDbGFzczogJ2NhbnZhcycsXHJcbiAgICAgIHdpZHRoOiAzMjAsXHJcbiAgICAgIGhlaWdodDogMjQwLFxyXG4gICAgICBhbGlnblg6ICdjZW50ZXInLFxyXG4gICAgICBhbGlnblk6ICdjZW50ZXInLFxyXG5cclxuICAgICAgZnBzOiAzMCwgLy8gVE9ET1xyXG4gICAgICB2aWRlb1VybDogJycsXHJcbiAgICAgIHBvc3RlclVybDogJycsXHJcblxyXG4gICAgICBhdXRvcGxheTogdHJ1ZSxcclxuICAgICAgbG9vcDogdHJ1ZSxcclxuICAgICAgbXV0ZWQ6IGZhbHNlLFxyXG5cclxuICAgICAgY2FucGxheUNhbGxiYWNrOiBudWxsLFxyXG4gICAgICB0aW1ldXBkYXRlQ2FsbGJhY2s6IG51bGwsXHJcbiAgICAgIGVuZGVkQ2FsbGJhY2s6IG51bGwsXHJcblxyXG4gICAgICB2aXNpYmlsaXR5Y2hhbmdlQ2FsbGJhY2s6IG51bGxcclxuICAgIH07XHJcbiAgICBPYmplY3QuYXNzaWduKF8ub3B0aW9uLCBvcHRpb25zKTtcclxuXHJcbiAgICBfLnBhcmVudCA9IF8ub3B0aW9uLnBhcmVudDtcclxuXHJcbiAgICBpZiAoXy5wYXJlbnQubGVuZ3RoIDw9IDApIHtcclxuICAgICAgdGhyb3cgbmV3IEVycm9yKCdGdWxsU2l6ZUNhbnZhc1ZpZGVvIENsYXNzIHJlcXVpcmUgb3B0aW9ucyBoYXZlIHBhcmVudC4nKTtcclxuICAgICAgcmV0dXJuO1xyXG4gICAgfVxyXG5cclxuICAgIF8uJHZpZGVvID0gbnVsbDtcclxuICAgIF8uJGNhbnZhcyA9IG51bGw7XHJcblxyXG4gICAgXy52aWRlbyA9IG51bGw7XHJcbiAgICBfLmNhbnZhcyA9IG51bGw7XHJcbiAgICBfLmN0eCA9IG51bGw7XHJcblxyXG4gICAgXy5pc1BsYXlpbmcgPSBmYWxzZTtcclxuICAgIF8ubGFzdFJlbmRlclRpbWUgPSAwO1xyXG4gICAgXy5hbmltYXRpb25GcmFtZSA9IG51bGw7XHJcblxyXG4gICAgXy4kcHJveHlSZXNpemUgPSAkLnByb3h5KF8ucmVzaXplLCBfKTtcclxuICB9XHJcblxyXG4gIGluaXQob2JqKSB7XHJcbiAgICB0aGlzLnNldEluc3RhbmNlKCk7XHJcbiAgICB0aGlzLnNldENhbGxiYWNrcygpO1xyXG4gIH1cclxuXHJcbiAgc2V0SW5zdGFuY2UoKSB7XHJcbiAgICBsZXQgXyA9IHRoaXMsXHJcbiAgICAgIG9wdCA9IF8ub3B0aW9uO1xyXG5cclxuICAgIF8uJHZpZGVvID0gJChfLmdldFZpZGVvVHBsKCkpO1xyXG4gICAgXy4kY2FudmFzID0gJChfLmdldENhbnZhc1RwbCgpKTtcclxuICAgIF8ucGFyZW50LmFwcGVuZChfLiR2aWRlbyk7XHJcbiAgICBfLnBhcmVudC5hcHBlbmQoXy4kY2FudmFzKTtcclxuXHJcbiAgICBfLnZpZGVvID0gXy4kdmlkZW8uZ2V0KDApO1xyXG4gICAgXy5jYW52YXMgPSBfLiRjYW52YXMuZ2V0KDApO1xyXG4gICAgXy5jdHggPSB0aGlzLmNhbnZhcy5nZXRDb250ZXh0KCcyZCcpO1xyXG5cclxuICAgIGlmIChvcHQubG9vcCA9PT0gdHJ1ZSkgXy52aWRlby5zZXRBdHRyaWJ1dGUoJ2xvb3AnLCAnJyk7XHJcbiAgICBpZiAob3B0Lm11dGVkID09PSB0cnVlKSBfLnZpZGVvLnNldEF0dHJpYnV0ZSgnbXV0ZWQnLCAnJyk7XHJcbiAgICBpZiAob3B0LmF1dG9wbGF5ID09PSB0cnVlKSBfLnZpZGVvLnNldEF0dHJpYnV0ZSgnYXV0b3BsYXknLCAnJyk7IC8vIGlPUyB2aWRlbyBub2RlIGFscmVhZHkgaGFzIFwiYXV0b3BsYXlcIiBhdHRyaWJ1dGVcclxuXHJcbiAgICBsZXQgc2l6ZSA9IF8uZ2V0VmlkZW9TaXplQXNwZWN0RmlsbCgpO1xyXG4gICAgXy5zZXRWaWRlb1NpemUoc2l6ZS53aWR0aCwgc2l6ZS5oZWlnaHQpO1xyXG4gICAgXy5zZXRDYW52YXNTaXplKHNpemUud2lkdGgsIHNpemUuaGVpZ2h0KTtcclxuICAgIF8uc2V0V3JhcEFsaWduKG9wdC5hbGlnblgsIG9wdC5hbGlnblksIHNpemUpO1xyXG5cclxuICAgIGxldCBpc1ZpZGVvSGFzT25lbmRlZCA9IF8udmlkZW8uaGFzT3duUHJvcGVydHkoJ29uZW5kZWQnKTtcclxuICAgIGlmIChfLmlzSU9TKCkpIHtcclxuICAgICAgXy4kdmlkZW8uaGlkZSgpO1xyXG5cclxuICAgICAgXy5wbGF5KCk7XHJcbiAgICAgIGlmICghXy5vcHRpb24uYXV0b3BsYXkpIF8ucGF1c2UoKTtcclxuXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICB0aGlzLiRjYW52YXMuaGlkZSgpO1xyXG5cclxuICAgICAgXy4kdmlkZW8ub24oJ2NsaWNrJywgKGV2dCkgPT4ge1xyXG4gICAgICAgIF8ucGxheSgpO1xyXG4gICAgICB9KTtcclxuICAgIH1cclxuXHJcbiAgICAkKHdpbmRvdykub24oJ3Jlc2l6ZScsIF8uJHByb3h5UmVzaXplKTtcclxuICAgIF8ucmVzaXplKCk7XHJcbiAgfVxyXG5cclxuICBzZXRDYWxsYmFja3MoKSB7XHJcbiAgICBsZXQgXyA9IHRoaXMsXHJcbiAgICAgIG9wdCA9IF8ub3B0aW9uLFxyXG4gICAgICBpc1ZpZGVvSGFzT25lbmRlZCA9IF8udmlkZW8uaGFzT3duUHJvcGVydHkoJ29uZW5kZWQnKTtcclxuXHJcbiAgICBpZiggXy5pc0lPUygpICkge1xyXG4gICAgICBfLiR2aWRlby5vbignY2FucGxheScsIChldnQpID0+IHtcclxuICAgICAgICBfLmRyYXdWaWRlb1RvQ2FudmFzKCk7XHJcbiAgICAgICAgaWYgKG9wdC5jYW5wbGF5Q2FsbGJhY2spIHtcclxuICAgICAgICAgIG9wdC5jYW5wbGF5Q2FsbGJhY2suY2FsbChudWxsLCB7XHJcbiAgICAgICAgICAgIGV2ZW50OiBldnQsXHJcbiAgICAgICAgICAgIHZpZGVvOiBfLnZpZGVvXHJcbiAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pO1xyXG5cclxuICAgICAgXy4kdmlkZW8ub24oJ3RpbWV1cGRhdGUnLCAoZXZ0KSA9PiB7XHJcbiAgICAgICAgXy5kcmF3VmlkZW9Ub0NhbnZhcygpO1xyXG5cclxuICAgICAgICBpZiAob3B0LnRpbWV1cGRhdGVDYWxsYmFjaykge1xyXG4gICAgICAgICAgb3B0LnRpbWV1cGRhdGVDYWxsYmFjay5jYWxsKG51bGwsIHtcclxuICAgICAgICAgICAgZXZlbnQ6IGV2dCxcclxuICAgICAgICAgICAgdmlkZW86IF8udmlkZW8sXHJcbiAgICAgICAgICAgIGN1cnJlbnRUaW1lOiBfLnZpZGVvLmN1cnJlbnRUaW1lLFxyXG4gICAgICAgICAgICBkdXJhdGlvbjogXy52aWRlby5kdXJhdGlvblxyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9KTtcclxuXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBfLiR2aWRlby5vbignY2FucGxheScsIChldnQpID0+IHtcclxuICAgICAgICBpZiAob3B0LmNhbnBsYXlDYWxsYmFjaykge1xyXG4gICAgICAgICAgb3B0LmNhbnBsYXlDYWxsYmFjay5jYWxsKG51bGwsIHtcclxuICAgICAgICAgICAgZXZlbnQ6IGV2dCxcclxuICAgICAgICAgICAgdmlkZW86IF8udmlkZW9cclxuICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgfSk7XHJcblxyXG4gICAgICBpZiAob3B0LnRpbWV1cGRhdGVDYWxsYmFjayB8fCAoIWlzVmlkZW9IYXNPbmVuZGVkICYmIG9wdC5lbmRlZENhbGxiYWNrKSkge1xyXG4gICAgICAgIF8uJHZpZGVvLm9uKCd0aW1ldXBkYXRlJywgKGV2dCkgPT4ge1xyXG4gICAgICAgICAgaWYgKG9wdC50aW1ldXBkYXRlQ2FsbGJhY2spIHtcclxuICAgICAgICAgICAgb3B0LnRpbWV1cGRhdGVDYWxsYmFjay5jYWxsKG51bGwsIHtcclxuICAgICAgICAgICAgICBldmVudDogZXZ0LFxyXG4gICAgICAgICAgICAgIHZpZGVvOiBfLnZpZGVvLFxyXG4gICAgICAgICAgICAgIGN1cnJlbnRUaW1lOiBfLnZpZGVvLmN1cnJlbnRUaW1lLFxyXG4gICAgICAgICAgICAgIGR1cmF0aW9uOiBfLnZpZGVvLmR1cmF0aW9uXHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgICAgfVxyXG5cclxuICAgICAgICAgIGlmIChvcHQuZW5kZWRDYWxsYmFjayAmJiAoXy52aWRlby5jdXJyZW50VGltZSA+PSBfLnZpZGVvLmR1cmF0aW9uKSkge1xyXG4gICAgICAgICAgICBpZihvcHQubG9vcCA9PT0gdHJ1ZSkgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgXy5pc1BsYXlpbmcgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgICAgIG9wdC5lbmRlZENhbGxiYWNrLmNhbGwobnVsbCwge1xyXG4gICAgICAgICAgICAgIGV2ZW50OiBldnQsXHJcbiAgICAgICAgICAgICAgdmlkZW86IF8udmlkZW8sXHJcbiAgICAgICAgICAgICAgY3VycmVudFRpbWU6IF8udmlkZW8uY3VycmVudFRpbWUsXHJcbiAgICAgICAgICAgICAgZHVyYXRpb246IF8udmlkZW8uZHVyYXRpb25cclxuICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgIGlmIChpc1ZpZGVvSGFzT25lbmRlZCAmJiBvcHQuZW5kZWRDYWxsYmFjaykge1xyXG4gICAgICAgIC8vIFRPRE8gLSBubyBicm93c2VyIHN1cHBvcnQgJ2VuZGVkJyBldmVudCBub3cuXHJcbiAgICAgICAgJCh2aWRlbykub24oJ2VuZGVkJywgKGV2dCkgPT4ge1xyXG4gICAgICAgICAgXy5pc1BsYXlpbmcgPSBmYWxzZTtcclxuXHJcbiAgICAgICAgICBvcHQuZW5kZWRDYWxsYmFjay5jYWxsKG51bGwsIHtcclxuICAgICAgICAgICAgZXZlbnQ6IGV2dCxcclxuICAgICAgICAgICAgdmlkZW86IF8udmlkZW8sXHJcbiAgICAgICAgICAgIGN1cnJlbnRUaW1lOiBfLnZpZGVvLmN1cnJlbnRUaW1lLFxyXG4gICAgICAgICAgICBkdXJhdGlvbjogXy52aWRlby5kdXJhdGlvblxyXG4gICAgICAgICAgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBpZihvcHQudmlzaWJpbGl0eWNoYW5nZUNhbGxiYWNrKSB7XHJcbiAgICAgIC8vIHRvZG8gLSBwYyB2XHJcbiAgICAgIGxldCBoaWRkZW4sIHZpc2liaWxpdHlTdGF0ZSwgdmlzaWJpbGl0eUNoYW5nZTtcclxuICAgICAgaWYgKHR5cGVvZiBkb2N1bWVudC5oaWRkZW4gIT09ICd1bmRlZmluZWQnKSB7IC8vIE9wZXJhIDEyLjEwIGFuZCBGaXJlZm94IDE4IGFuZCBsYXRlciBzdXBwb3J0XHJcbiAgICAgICAgaGlkZGVuID0gJ2hpZGRlbic7XHJcbiAgICAgICAgdmlzaWJpbGl0eVN0YXRlID0gJ3Zpc2liaWxpdHlTdGF0ZSc7XHJcbiAgICAgICAgdmlzaWJpbGl0eUNoYW5nZSA9ICd2aXNpYmlsaXR5Y2hhbmdlJztcclxuICAgICAgfSBlbHNlIGlmICh0eXBlb2YgZG9jdW1lbnQubXNIaWRkZW4gIT09ICd1bmRlZmluZWQnKSB7XHJcbiAgICAgICAgaGlkZGVuID0gJ21zSGlkZGVuJztcclxuICAgICAgICB2aXNpYmlsaXR5U3RhdGUgPSAnbXNWaXNpYmlsaXR5U3RhdGUnO1xyXG4gICAgICAgIHZpc2liaWxpdHlDaGFuZ2UgPSAnbXN2aXNpYmlsaXR5Y2hhbmdlJztcclxuICAgICAgfSBlbHNlIGlmICh0eXBlb2YgZG9jdW1lbnQud2Via2l0SGlkZGVuICE9PSAndW5kZWZpbmVkJykge1xyXG4gICAgICAgIGhpZGRlbiA9ICd3ZWJraXRIaWRkZW4nO1xyXG4gICAgICAgIHZpc2liaWxpdHlTdGF0ZSA9ICd3ZWJraXRWaXNpYmlsaXR5U3RhdGUnO1xyXG4gICAgICAgIHZpc2liaWxpdHlDaGFuZ2UgPSAnd2Via2l0dmlzaWJpbGl0eWNoYW5nZSc7XHJcbiAgICAgIH1cclxuXHJcbiAgICAgICQoZG9jdW1lbnQpLm9uKHZpc2liaWxpdHlDaGFuZ2UsIChldnQpID0+IHtcclxuICAgICAgICBjb25zb2xlLmxvZygndmlzaWJpbGl0eWNoYW5nZSA6JywgZXZ0KTtcclxuICAgICAgICBjb25zb2xlLmxvZygnaGlkZGVuJywgZG9jdW1lbnRbaGlkZGVuXSk7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ3Zpc2liaWxpdHlTdGF0ZScsIGRvY3VtZW50W3Zpc2liaWxpdHlTdGF0ZV0pOyAvLyB2aXNpYmxlLCBoaWRkZW4sIHByZXJlbmRlciwgdW5sb2FkZWRcclxuXHJcbiAgICAgICAgb3B0LnZpc2liaWxpdHljaGFuZ2VDYWxsYmFjay5jYWxsKG51bGwsIHtcclxuICAgICAgICAgIGV2ZW50OiBldnQsXHJcbiAgICAgICAgICB2aWRlbzogXy52aWRlbyxcclxuICAgICAgICAgIGRvY3VtZW50SGlkZGVuOiBkb2N1bWVudFtoaWRkZW5dLFxyXG4gICAgICAgICAgZG9jdW1lbnRWaXNpYmlsaXR5U3RhdGU6IGRvY3VtZW50W3Zpc2liaWxpdHlTdGF0ZV1cclxuICAgICAgICB9KTtcclxuICAgICAgfSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBzZXRXcmFwQWxpZ24oYWxpZ25YLCBhbGlnblksIG1vZGlmaWVkU2l6ZSkge1xyXG4gICAgbGV0IHdpbldpZHRoID0gd2luZG93LmlubmVyV2lkdGgsXHJcbiAgICAgIHdpbkhlaWdodCA9IHdpbmRvdy5pbm5lckhlaWdodCxcclxuICAgICAgbGVmdCA9IDAsXHJcbiAgICAgIHRvcCA9IDA7XHJcblxyXG4gICAgc3dpdGNoIChhbGlnblgpIHtcclxuICAgICAgY2FzZSAnbGVmdCcgOlxyXG4gICAgICAgIGxlZnQgPSAwO1xyXG4gICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgY2FzZSAnY2VudGVyJyA6XHJcbiAgICAgICAgbGVmdCA9IE1hdGgucm91bmQoKHdpbldpZHRoIC0gbW9kaWZpZWRTaXplLndpZHRoKSAvIDIpO1xyXG4gICAgICAgIGJyZWFrO1xyXG5cclxuICAgICAgY2FzZSAncmlnaHQnIDpcclxuICAgICAgICBsZWZ0ID0gTWF0aC5yb3VuZCh3aW5XaWR0aCAtIG1vZGlmaWVkU2l6ZS53aWR0aCk7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgICB9XHJcblxyXG4gICAgc3dpdGNoIChhbGlnblkpIHtcclxuICAgICAgY2FzZSAndG9wJyA6XHJcbiAgICAgICAgdG9wID0gMDtcclxuICAgICAgICBicmVhaztcclxuXHJcbiAgICAgIGNhc2UgJ2NlbnRlcicgOlxyXG4gICAgICAgIHRvcCA9IE1hdGgucm91bmQoKHdpbkhlaWdodCAtIG1vZGlmaWVkU2l6ZS5oZWlnaHQpIC8gMik7XHJcbiAgICAgICAgYnJlYWs7XHJcblxyXG4gICAgICBjYXNlICdib3R0b20nIDpcclxuICAgICAgICB0b3AgPSBNYXRoLnJvdW5kKHdpbkhlaWdodCAtIG1vZGlmaWVkU2l6ZS5oZWlnaHQpO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgfVxyXG5cclxuICAgIHRoaXMuc2V0VmlkZW9Qb3NpdGlvbih7bGVmdDogbGVmdCwgdG9wOiB0b3B9KTtcclxuICAgIHRoaXMuc2V0Q2FudmFzUG9zaXRpb24oe2xlZnQ6IGxlZnQsIHRvcDogdG9wfSlcclxuICB9XHJcblxyXG4gIHNldFZpZGVvUG9zaXRpb24oY3NzT2JqKSB7XHJcbiAgICB0aGlzLiR2aWRlby5jc3MoY3NzT2JqKTtcclxuICB9XHJcblxyXG4gIHNldENhbnZhc1Bvc2l0aW9uKGNzc09iaikge1xyXG4gICAgdGhpcy4kY2FudmFzLmNzcyhjc3NPYmopO1xyXG4gIH1cclxuXHJcbiAgc2V0VmlkZW9TaXplKHdpZHRoLCBoZWlnaHQpIHtcclxuICAgIHRoaXMuJHZpZGVvLndpZHRoKHdpZHRoKTtcclxuICAgIHRoaXMuJHZpZGVvLmhlaWdodChoZWlnaHQpO1xyXG4gIH1cclxuXHJcbiAgc2V0Q2FudmFzU2l6ZSh3aWR0aCwgaGVpZ2h0KSB7XHJcbiAgICBsZXQgXyA9IHRoaXM7XHJcblxyXG4gICAgaWYgKF8uaXNJT1MoKSkge1xyXG4gICAgICBfLmN0eC5jYW52YXMud2lkdGggPSB3aWR0aDtcclxuICAgICAgXy5jdHguY2FudmFzLmhlaWdodCA9IGhlaWdodDtcclxuICAgICAgXy4kY2FudmFzLmF0dHIoe3dpZHRoOiB3aWR0aCwgaGVpZ2h0OiBoZWlnaHR9KTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIGRyYXdWaWRlb1RvQ2FudmFzKCkge1xyXG4gICAgbGV0IF8gPSB0aGlzO1xyXG4gICAgXy5jdHguZHJhd0ltYWdlKF8udmlkZW8sIDAsIDAsIF8uJHZpZGVvLndpZHRoKCksIF8uJHZpZGVvLmhlaWdodCgpKTtcclxuICB9XHJcblxyXG4gIGxvb3BBbmltYXRpb25GcmFtZUlPUygpIHtcclxuICAgIGxldCBfID0gdGhpcyxcclxuICAgICAgb3B0ID0gXy5vcHRpb247XHJcblxyXG4gICAgbGV0IG5vdyA9IERhdGUubm93KCksXHJcbiAgICAgIGVsYXBzZWRUaW1lID0gKCBub3cgLSBfLmxhc3RSZW5kZXJUaW1lICkgLyAxMDAwO1xyXG5cclxuICAgIGlmIChlbGFwc2VkVGltZSA+PSAoMSAvIF8ub3B0aW9uLmZwcykpIHtcclxuICAgICAgXy52aWRlby5jdXJyZW50VGltZSA9IF8udmlkZW8uY3VycmVudFRpbWUgKyBlbGFwc2VkVGltZTtcclxuICAgICAgXy5sYXN0UmVuZGVyVGltZSA9IG5vdztcclxuICAgIH1cclxuXHJcbiAgICBpZiAoXy52aWRlby5jdXJyZW50VGltZSA+PSBfLnZpZGVvLmR1cmF0aW9uKSB7XHJcbiAgICAgIF8uaXNQbGF5aW5nID0gZmFsc2U7XHJcblxyXG4gICAgICBpZiAob3B0Lmxvb3AgPT09IHRydWUpIHtcclxuICAgICAgICBfLnNlZWsoMCk7XHJcbiAgICAgICAgXy5wbGF5KCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgb3B0LmVuZGVkQ2FsbGJhY2suY2FsbChudWxsLCB7XHJcbiAgICAgICAgICBldmVudDogbnVsbCxcclxuICAgICAgICAgIHZpZGVvOiBfLnZpZGVvLFxyXG4gICAgICAgICAgY3VycmVudFRpbWU6IF8udmlkZW8uY3VycmVudFRpbWUsXHJcbiAgICAgICAgICBkdXJhdGlvbjogXy52aWRlby5kdXJhdGlvblxyXG4gICAgICAgIH0pO1xyXG5cclxuICAgICAgICBfLnN0b3AoKTtcclxuICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGlmIChfLmlzUGxheWluZykge1xyXG4gICAgICBfLmFuaW1hdGlvbkZyYW1lID0gcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+IHtcclxuICAgICAgICBfLmxvb3BBbmltYXRpb25GcmFtZUlPUygpO1xyXG4gICAgICB9KTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIGNhbmNlbEFuaW1hdGlvbkZyYW1lKF8uYW5pbWF0aW9uRnJhbWUpO1xyXG4gICAgICBfLmFuaW1hdGlvbkZyYW1lID0gbnVsbDtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHJlc2l6ZShldnQpIHtcclxuICAgIGxldCBfID0gdGhpcyxcclxuICAgICAgc2l6ZSA9IF8uZ2V0VmlkZW9TaXplQXNwZWN0RmlsbCgpO1xyXG5cclxuICAgIF8uc2V0VmlkZW9TaXplKHNpemUud2lkdGgsIHNpemUuaGVpZ2h0KTtcclxuICAgIF8uc2V0Q2FudmFzU2l6ZShzaXplLndpZHRoLCBzaXplLmhlaWdodCk7XHJcbiAgICBfLnNldFdyYXBBbGlnbihfLm9wdGlvbi5hbGlnblgsIF8ub3B0aW9uLmFsaWduWSwgc2l6ZSk7XHJcblxyXG4gICAgaWYgKF8uaXNJT1MoKSkgXy5kcmF3VmlkZW9Ub0NhbnZhcygpO1xyXG4gIH1cclxuXHJcbiAgZ2V0VmlkZW9UcGwoKSB7XHJcbiAgICBsZXQgXyA9IHRoaXMsXHJcbiAgICAgIG9wdCA9IF8ub3B0aW9uO1xyXG5cclxuICAgIGxldCB2aWRlb1NvdXJjZVRwbCA9ICcnLFxyXG4gICAgICBleHQgPSBvcHQudmlkZW9Vcmwuc3BsaXQoJy4nKS5wb3AoKS50b0xvd2VyQ2FzZSgpO1xyXG4gICAgdmlkZW9Tb3VyY2VUcGwgKz0gYDxzb3VyY2Ugc3JjPVwiJHtvcHQudmlkZW9Vcmx9XCIgdHlwZT1cInZpZGVvLyR7ZXh0fVwiPjwvc291cmNlPmA7XHJcblxyXG4gICAgbGV0IHRwbCA9IGA8dmlkZW8gY2xhc3M9XCIke29wdC52aWRlb0NsYXNzfVwiIHBvc3Rlcj1cIiR7b3B0LnBvc3RlclVybH1cIj4ke3ZpZGVvU291cmNlVHBsfTwvdmlkZW8+YDtcclxuICAgIGlmIChfLmlzSU9TKCkpIHtcclxuICAgICAgdHBsID0gYDx2aWRlbyBjbGFzcz1cIiR7b3B0LnZpZGVvQ2xhc3N9XCIgcG9zdGVyPVwiJHtvcHQucG9zdGVyVXJsfVwiIGF1dG9wbGF5PiR7dmlkZW9Tb3VyY2VUcGx9PC92aWRlbz5gO1xyXG4gICAgfVxyXG4gICAgLy9sZXQgdHBsID0gYDx2aWRlbyBjbGFzcz1cIiR7b3B0LnZpZGVvQ2xhc3N9XCIgbXV0ZWQ9XCJ0cnVlXCIgbG9vcD1cInRydWVcIiBhdXRvcGxheT1cInRydWVcIiBwb3N0ZXI9XCJcIj4ke3ZpZGVvU291cmNlVHBsfTwvdmlkZW8+YDtcclxuXHJcbiAgICByZXR1cm4gdHBsO1xyXG4gIH1cclxuXHJcbiAgZ2V0Q2FudmFzVHBsKCkge1xyXG4gICAgcmV0dXJuIGA8Y2FudmFzIGNsYXNzPVwiJHt0aGlzLm9wdGlvbi5jYW52YXNDbGFzc31cIj48L2NhbnZhcz5gO1xyXG4gIH1cclxuXHJcbiAgZ2V0VmlkZW9TaXplQXNwZWN0RmlsbCgpIHtcclxuICAgIGxldCBfID0gdGhpcyxcclxuICAgICAgb3B0ID0gXy5vcHRpb247XHJcblxyXG4gICAgbGV0IHdpbldpZHRoID0gd2luZG93LmlubmVyV2lkdGgsXHJcbiAgICAgIHdpbkhlaWdodCA9IHdpbmRvdy5pbm5lckhlaWdodCxcclxuICAgICAgbW9kaWZpZWRTaXplVyA9IHdpbldpZHRoLFxyXG4gICAgICBtb2RpZmllZFNpemVIID0gTWF0aC5jZWlsKCh3aW5XaWR0aCAvIG9wdC53aWR0aCkgKiBvcHQuaGVpZ2h0KTtcclxuXHJcbiAgICBpZiAobW9kaWZpZWRTaXplSCA8IHdpbkhlaWdodCkge1xyXG4gICAgICBtb2RpZmllZFNpemVXID0gTWF0aC5jZWlsKCh3aW5IZWlnaHQgLyBvcHQuaGVpZ2h0KSAqIG9wdC53aWR0aCk7XHJcbiAgICAgIG1vZGlmaWVkU2l6ZUggPSB3aW5IZWlnaHQ7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgd2lkdGg6IG1vZGlmaWVkU2l6ZVcsXHJcbiAgICAgIGhlaWdodDogbW9kaWZpZWRTaXplSFxyXG4gICAgfTtcclxuICB9XHJcblxyXG4gIGlzSU9TKCkge1xyXG4gICAgcmV0dXJuIC9pUGFkfGlQaG9uZXxpUG9kLy50ZXN0KG5hdmlnYXRvci5wbGF0Zm9ybSk7XHJcbiAgfVxyXG5cclxuICBwbGF5KCkge1xyXG4gICAgbGV0IF8gPSB0aGlzO1xyXG4gICAgaWYgKCFfLnZpZGVvKSByZXR1cm47XHJcblxyXG4gICAgaWYgKF8uaXNJT1MoKSkge1xyXG4gICAgICBfLmxhc3RSZW5kZXJUaW1lID0gRGF0ZS5ub3coKTtcclxuICAgICAgXy5pc1BsYXlpbmcgPSB0cnVlO1xyXG4gICAgICBfLmxvb3BBbmltYXRpb25GcmFtZUlPUygpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgXy5pc1BsYXlpbmcgPSB0cnVlO1xyXG4gICAgICBfLnZpZGVvLnBsYXkoKTtcclxuICAgIH1cclxuICB9XHJcblxyXG4gIHBhdXNlKCkge1xyXG4gICAgbGV0IF8gPSB0aGlzO1xyXG4gICAgaWYgKCFfLnZpZGVvKSByZXR1cm47XHJcblxyXG4gICAgaWYgKF8uaXNJT1MoKSkge1xyXG4gICAgICBfLmlzUGxheWluZyA9IGZhbHNlO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgXy5pc1BsYXlpbmcgPSBmYWxzZTtcclxuICAgICAgXy52aWRlby5wYXVzZSgpO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgc3RvcCgpIHtcclxuICAgIGxldCBfID0gdGhpcztcclxuICAgIGlmICghXy52aWRlbykgcmV0dXJuO1xyXG5cclxuICAgIGlmIChfLmlzSU9TKCkpIHtcclxuICAgICAgXy5wYXVzZSgpO1xyXG4gICAgICBfLnNlZWsoMCk7XHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBfLnZpZGVvLnBhdXNlKCk7XHJcbiAgICAgIF8udmlkZW8uY3VycmVudFRpbWUgPSAwO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgc2VlayhzZWNvbmQpIHtcclxuICAgIGxldCBfID0gdGhpcztcclxuICAgIGlmICghXy52aWRlbykgcmV0dXJuO1xyXG5cclxuICAgIGlmIChfLmlzSU9TKCkpIHtcclxuICAgICAgXy52aWRlby5jdXJyZW50VGltZSA9IHNlY29uZDtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIF8udmlkZW8uY3VycmVudFRpbWUgPSBzZWNvbmQ7XHJcbiAgICB9XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgZGVmYXVsdCBGdWxsU2l6ZUNhbnZhc1ZpZGVvO1xuXG5cbi8vIFdFQlBBQ0sgRk9PVEVSIC8vXG4vLyAuL2FwcC9zcmMvY29tcG9uZW50L0Z1bGxTaXplQ2FudmFzVmlkZW8uanMiXSwic291cmNlUm9vdCI6IiJ9");
}]);